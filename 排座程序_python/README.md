# 学生分组与座位排号程序

## 功能介绍

这个程序用于将学生按照要求进行分组和排座，主要功能包括：

- 创建34名学生的模拟数据（根据文件夹中的统计信息，包含物流241和物流242两个班级）
- 按照指定规则进行分组：
  - 分为A、B、C、D、E、F共6个组
  - D组和F组为5人，其他4组为6人
  - 每组的男女生数量尽量平均
- 为每个学生分配座位号
- 打印分组和排座结果
- 导出结果到Excel文件

## 环境要求

- Python 3.6+ 
- 依赖包：pandas, openpyxl

## 安装依赖

在运行程序之前，请先安装所需的依赖包：

```bash
pip install -r requirements.txt
```

## 使用方法

1. 确保已安装所有依赖包
2. 运行主程序：

```bash
python student_seating.py
```

3. 程序将会：
   - 显示分组和排座结果在控制台
   - 在当前目录下生成Excel文件 `学生分组排座结果.xlsx`

## 程序结构

- `student_seating.py` - 主程序文件，包含所有功能实现
- `requirements.txt` - 依赖包列表
- `学生分组排座结果.xlsx` - 程序运行后生成的结果文件（运行后才会出现）

## 注意事项

1. 程序中的学生数据是模拟数据，根据文件夹中的统计信息创建
2. 如需使用真实学生数据，请修改 `_create_sample_students` 方法中的数据
3. 分组结果每次运行可能会有所不同，因为程序使用了随机打乱功能
4. 如需修改分组规则（如组数、每组人数等），请修改 `group_students` 方法中的相关配置

## 随机分组实现机制

本程序采用了多层次的随机分组算法，确保分组结果的随机性和公平性，具体实现如下：

1. **数据预处理**
   - 首先将所有学生按性别分为男生列表和女生列表
   - 使用`random.shuffle()`函数对男生列表和女生列表进行随机打乱，确保初始顺序的随机性

2. **均衡分配算法**
   - 根据总学生数和各组配置人数，计算每个组的理想男女生比例
   - 从打乱后的男生和女生列表中依次分配学生到各个组
   - 确保每个组至少有1名男生和1名女生（除非组内总人数为1）

3. **剩余学生分配策略**
   - 对于未能按照理想比例分配的剩余学生，按照性别均衡原则补充到各个组
   - 优先考虑人数较少的组进行补充，以平衡各组人数

4. **强制重新分配机制**
   - 在分配完成后，程序会检查各组人数是否符合配置要求
   - 如果发现人数不符或总分配人数与实际学生总数不匹配，程序会触发强制重新分配
   - 重新分配时，会重新打乱所有学生并按照配置人数直接分配

5. **座位号随机分配**
   - 在每个组内，座位号的分配也是随机的，确保不同座位的机会均等

通过以上多层次的随机化处理，程序能够确保每次运行都产生不同的分组结果，同时保持各组间的人数和性别比例均衡。

## 常见问题

1. **运行时提示缺少依赖包**：请确保已安装requirements.txt中的所有包
2. **导出Excel文件失败**：请检查是否有写入权限，以及目标路径是否存在
3. **结果不符合预期**：可以多次运行程序，因为每次运行的随机结果可能不同

## 更新日志

- 初始版本：实现基本的学生分组和排座功能
- 优化版本：改进了随机分组算法，增强了性别分配的均衡性，修复了人数不足问题